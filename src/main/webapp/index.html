<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <title>Janus</title>
    
    <!-- meta page configuration -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="">

    <!-- Bootstrap -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="static/css/font-awesome.min.css" rel="stylesheet">

    <!-- janus -->
    <link href="static/css/janus.css" rel="stylesheet" media="screen">

	<!-- future-press -->
	<link rel="stylesheet" href="static/fpjs/css/popup.css">
	<link rel="stylesheet" href="static/fpjs/css/main.css">

    <!-- book display template -->
    <script id="book-template" type="text/x-handlebars-template">
      <div class="row">
        <div class="span6 entry">
          <!-- permalink -->
		  <div class="pull-right permalink"><a href="#/{{type}}/get/{{id}}"><i class="icon-link"></i></a></div>

		  <h4 class="title"><em>{{mainTitle}}</em></h4>
		  {{#if subTitle}}
			<h5 class="subtitle"><em>{{subTitle}}</em></h5>
          {{/if}}
		  {{#if series}}
            <h6>Book {{seriesIndex}} in <em><a href="#/series/get/{{series.id}}">{{series.name}}</a></em></h6>
          {{/if}}
 
	      <div class="media">
            <a class="pull-left" href="#">
              <img src="static/img/thumbnail.jpg" data-src="s/book/{{id}}/cover?w=67&h=90" height="90" width="67" class="thumbnail lazy entryThumb"/>
            </a>
            
            <div class="media-body">
              {{#if authors}}
                <p><i class="icon-group"></i>&nbsp;
                {{#each authors}}
                  <a class="btn btn-default btn-xs" href="#/author/get/{{id}}" type="button">{{name}}</a>
                {{/each}}</p>
              {{/if}}
              
              {{#if tags}}
                <p><i class="icon-tags"></i>&nbsp;
                {{#each tags}}
                  <a class="btn btn-default btn-xs" href="#/tag/get/{{id}}" type="button">{{name}}</a>
                {{/each}}</p>
                </p>
              {{/if}}

			  <!-- download(s) -->
          	  {{#if fileInfo}}
            	<!-- starts local download -->
            	<p><i class="icon-download-alt"></i>&nbsp;
            	{{#each fileInfo}}
				  <a class="btn btn-default btn-xs" target="_blank" href="s/book/{{../id}}/file/{{type}}" type="button">{{type}} ({{descriptiveSize}})</a>		
			    {{/each}}</p>
	          {{/if}}

			  <!-- other functions -->
			  <p><i class="icon-cogs"></i>&nbsp;
				<button class="btn btn-default btn-xs" onclick="toggleQR('{{type}}', '{{id}}', '{{inJavascriptEscape title}}')"><i class="icon-qrcode"></i></button>
				<button class="btn btn-default btn-xs" onclick="toggleBookEmail('{{id}}', '{{inJavascriptEscape title}}')"><i class="icon-envelope"></i></button>
				<!--
				<a class="btn btn-default btn-xs readLink" id="read_book_link_{{id}}" href="s/book/{{id}}/exploded"><i class="icon-book"></i></a>
				-->
			  </p>

			  <!-- ibsn -->
			  {{#if identifiers}}
                <p><i class="icon-info-sign"></i>&nbsp;
                {{# each identifiers}}
                  {{#if link}}
                    <a class="btn btn-default btn-xs" href="{{link}}">{{this/title}}</a>
                  {{/if}}
				{{/each}}</p>
			  {{/if}}
            </div> <!-- /end of media body -->
          </div> <!-- /end of media -->
        </div> <!-- /span -->
      </div> <!-- /row -->      
    </script>
    
    <!-- typed template specific to author -->
    <script id="generic-template" type="text/x-handlebars-template">
     <div class="row">
        <div class="span6 entry">
          <!-- permalink -->
		  <div class="pull-right permalink"><a href="#/{{type}}/get/{{id}}"><i class="icon-link"></i></a></div>

          <h4><em>{{name}}</em></h4>
  	      {{#if downloads}}
		    <p><em>Downloaded {{downloads}} times</em></p> 
	      {{/if}}

          <div class="media">
            <a class="pull-left" href="#">
              <img src="static/img/thumbnail.jpg" data-src="s/{{type}}/{{id}}/cover?w=67&h=90" height="90" width="67" class="thumbnail lazy entryThumb"/>
            </a>
            
            <div class="media-body">
              {{#if bookCount}}
                <h6>Author of <a href="#/{{type}}/get/{{id}}/books">{{bookCount}} books</a>{{#if seriesCount}} and <a href="#/{{type}}/get/{{id}}/series">{{seriesCount}} series</a>{{/if}}.</h6>
			  {{else}}
			  	<p><a href="#/{{type}}/get/{{id}}/books">related books <i class="icon-circle-arrow-right"></i></a></p>
              	<p><a href="#/{{type}}/get/{{id}}/series">related series <i class="icon-circle-arrow-right"></i></a></p>				
              {{/if}}
              
			  <!-- other items related to this author -->
              <p><a href="#/{{type}}/get/{{id}}/authors">related authors <i class="icon-circle-arrow-right"></i></a></p>
			  <p><a href="#/{{type}}/get/{{id}}/tags">related tags <i class="icon-circle-arrow-right"></i></a></p>		

            </div> <!--/end of media body -->
          </div> <!-- /end of media -->
        </div> <!-- /span -->
      </div> <!-- /row --> 
    </script>
    
    <!-- if you get a multi response this part will handle showing the table header -->   
    <script id="multi-response-header-template" type="text/x-handlebars-template">
      <div class="row">
        <div class="span12">
          <div class="row-fluid">
            <div class="6">
              <ul class="nav nav-pills">
                {{#if books}}
                <li class="book_tab">
                  <a onclick="toggleTarget('book')"><strong>Books</strong></a>
                </li>
                {{/if}}
                {{#if authors}}
                <li class="author_tab">
                  <a onclick="toggleTarget('author')"><strong>Authors</strong></a>
                </li>
                {{/if}}
                {{#if series}}
                <li class="series_tab">
                  <a onclick="toggleTarget('series')"><strong>Series</strong></a>
                </li>
                {{/if}}
                {{#if tags}}
                <li class="tag_tab">
                  <a onclick="toggleTarget('tag')"><strong>Tags</strong></a>
                </li>
                {{/if}}        
              </ul>
            </div>
          </div>
        </div>
      </div>      
    </script>
   
  </head>
  <body>
      	<!-- navigation bar -->
		<div class="janus-nav navbar navbar-inverse navbar-fixed-top">
		  <div class="container">
		    <div class="navbar-header">
		        <a class="navbar-brand" href="#">Janus</a>
			
	            <form class="navbar-form navbar-left" role="search" method="get" action="#/search/all">
			      <div class="form-group">
			        <input id="term" name="term" type="text" class="form-control input-sm" placeholder="Search">
			      </div>
			    </form>
			    
			</div>
	            
            <!-- version -->
            <div class="pull-right visible-md visible-lg" style="margin-top: 9px; color: #9f9f9f">
              <small>
                <em>
                  <span id="code-show"><i class="icon-code"></i> &nbsp;</span>
                  <span class="version" style="margin-top: 1px;"></span>
                </em>
              </small>
            </div>

		  </div>
		</div>

	  <!-- error div -->
      <div id="error-container" class="container main">
        <div class="row">
          <div class="span6">
            <div class="row-fluid">
              <div id="error-div" class="span12 errorBox">
              	<!-- errors go here -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- sample navigation options -->
      <div id="mainOptions" class="container main">
        <div class="row">
          <div class="span12 entry">
            <div class="row-fluid">
              <div class="span3">
                <h3>Books</h1>
                <h6><a href="#/book/list?sort=latest">Sorted by newest</a></h6>
                <h6><a href="#/book/list?sort=downloads">Sorted by download count</a></h6>
                <h6><a href="#/book/list?sort=name">Sorted by name</a></h6>
              </div>
              <div class="span3">
                <h3>Authors</h3>
                <h6><a href="#/author/list?sort=latest">Sorted by newest book</a></h6>
                <h6><a href="#/author/list?sort=books">Sorted by most books</a></h6>
                <h6><a href="#/author/list?sort=downloads">Sorted by download count</a></h6>
                <h6><a href="#/author/list?sort=series">Sorted by most series</a></h6>
                <h6><a href="#/author/list?sort=name">Sorted by name</a></h6>
              </div>
              <div class="span3">
                <h3>Series</h3>
                <h6><a href="#/series/list?sort=latest">Sorted by newest book</a></h6>
                <h6><a href="#/series/list?sort=books">Sorted by most books</a></h6>
                <h6><a href="#/series/list?sort=downloads">Sorted by download count</a></h6>
                <h6><a href="#/series/list?sort=name">Sorted by name</a></h6>
              </div>
              <div class="span3">
                <h3>Tags</h3>
                <h6><a href="#/tag/list?sort=latest">Sorted by newest book</a></h6>
                <h6><a href="#/tag/list?sort=books">Sorted by most books</a></h6>
                <h6><a href="#/tag/list?sort=downloads">Sorted by download count</a></h6>
                <h6><a href="#/tag/list?sort=name">Sorted by name</a></h6>
              </div>            
            </div>
          </div>
        </div>
      </div>

      <!-- this is where the search tab thing goes -->
      <div id="multi-header-target" class="container"></div>

      <!-- target div for new render items -->      
      <div id="target"></div>

      <!-- div that is shown when no data is found -->
      <div id="noMoreEntries" class="container" style="display: none">
        <div class="row">
          <div class="span6">
            <div class="row-fluid noMoreEntries">
              <div class="span12">
                <h4>no more entries found</h4>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div id="loadMoreLinkTarget" class="container">
        <!-- target div for href to load more -->
      </div>
      <br/>
      
      <!-- below this point there should be no 'active' content -->
      
      <!-- QR modal to save time on jquery construction -->
        <div id="qr-modal" class="modal fade">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
		       	<h3 id="qr-modal-label"></h3>
		      </div>
		      <div id="qr-modal-body" class="modal-body">
		        <p>One fine body&hellip;</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">close</button>
		      </div>
		    </div><!-- /.modal-content -->
		  </div><!-- /.modal-dialog -->
		</div><!-- /.modal -->
       	  
 	  <!-- EMAIL modal to save time on jquery construction -->
	<div class="modal fade" id="email-modal" tabindex="-1" role="dialog" aria-labelledby="email-modal" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
	        <h3 class="modal-title" id="email-modal-label"></h4>
	      </div>
	      <div class="modal-body" id="email-modal-body">
			<div class="row-fluid">
				<div class="span12">
					<form>
						<fieldset>
							<!-- this is how we know what book to get -->
							<input type="hidden" id="email-id"></input>
							
							<label class="hidden-phone">Email</label>
							<div class="input-prepend input-append">
							  <input id="email-text" class="span3" type="text" placeholder="email"></input>
							  <span class="add-on">@</span>
							  <input id="email-host" class="span3" type="text" placeholder="kindle" value="kindle"></input>
							  <span class="add-on">.</span>
							  <input id="email-tld" class="span2" type="text" placeholder="com" value="com"></input>
							</div>
							<label>Book File Type</label>
							<div id="email-type-holder">
							</div>
						</fieldset>
					</form>
				</div>
			</div>
			<div class="row-fluid">
				<div id="email-modal-error-container" class="span12">				
				</div>
			</div>
	      </div>
	      <div class="modal-footer">
			<button id="email-do-button" class="btn btn-success pull-left" onclick="doEmail()">send email</button>&nbsp;
			<button class="btn btn-danger" data-dismiss="modal" aria-hidden="true">close</button>
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

 	  
 	  <!-- from here down is the stuff for the future-press reading --> 	  
 	  <div id="sidebar" class="reading" style="display: none">
          <div id="controls">
            <!-- <input id="search" placeholder="search"> -->
            <a id="network"><img id="store" src="static/fpjs/img/save.png"></a>
            <a id="setting"><img id="settings" src="static/fpjs/img/settings.png"></a>
            <a id="bookmark"><img id="bookmarks" src="static/fpjs/img/star.png"></a>
          </div>
          <div id="toc"></div>
          <div id="settingsPanel"></div>            
      </div>
      <div id="main" class="reading" style="display: none">
        <div id="opener">
          <a id="open"><i class="icon-list"></i></a>
          <a id="close"><i class="icon-close"></i></a>
        </div>
        <div id="titlebar">
          <span id="book-title"></span>
          <span id="title-seperator">&nbsp;&nbsp;–&nbsp;&nbsp;</span>
          <span id="chapter-title"> </span>
        </div>
        <div id="divider"></div>
        <div id="prev" class="arrow">‹</div>
        <div id="area"></div>
        <div id="next" class="arrow">›</div>
        <div id="loader"><!-- todo: loader --></div>
      </div>

  	  <!-- supporting scripts -->
      <script src="static/js/jquery-2.0.0.min.js"></script>
      <script src="static/js/bootstrap.min.js"></script>
      <script src="static/js/handlebars.js"></script>
      <script src="static/js/sammy.js"></script>
      <script src="static/js/jail.min.js"></script>
      <script src="static/js/jquery-waypoints-2.0.2.min.js"></script>
      
      <!-- janus logic -->
      <script src="static/janus/janus-config.js"></script>
      <script src="static/janus/janus-utilities.js"></script>
      <script src="static/janus/janus-template.js"></script>
      <script src="static/janus/janus-request.js"></script>
      <script src="static/janus/janus-render.js"></script>
      <script src="static/janus/janus-sammy.js"></script>
      <script src="static/janus/janus-email.js"></script>
      <script src="static/janus/janus-read.js"></script>
      
      <!-- future-press specific logic -->
      <script src="static/fpjs/dist/libs/modernizr-2.6.2.min.js"></script>
      <script src="static/fpjs/dist/render.min.js"></script>
      <script async src="static/fpjs/dist/hooks/hooks.min.js"></script>
      <script src="static/fpjs/dist/reader.min.js"></script>
      <script src="static/fpjs/dist/libs/fileStorage.min.js"></script>
      <script src="static/fpjs/dist/libs/zip.js"></script>      

      <!-- handlebars template stuff -->
      <script>
        $(document).ready(function() {
		  // load default values from cookies
		  loadConfigurationFromCookies();

		  // ensure all modals are hidden to start
		  $(".modal").modal('hide')
          
          // initialize sammy application
          initSammy();

          // make sure version is hidden and that it is 
          // being retrieved 
		  logger("[version] getting version...");
		  $('.version').hide();
          
          // call for version 
          $.ajax({
            "url": 's/status/version',
            "cache": false
          })
          .done(
            function(context) {
              logger("[version] got version: " + context);
                
              $('.version').html(context);
              $('#code-show').click(function(){
                $('.version').toggle();
              });
            }
          );
        });
    </script>
  </body>
</html>